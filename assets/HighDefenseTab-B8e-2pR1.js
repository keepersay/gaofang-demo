import{_ as q,r as M,a as b,n as F,o as G,e as d,b as C,g as I,h as s,d as t,w as a,k as r,t as J}from"./index-BNzg1WGg.js";const K={class:"high-defense-tab"},Y={class:"tab-header"},Z={class:"tab-actions"},$={key:0,class:"tab-content"},ee={class:"rule-categories"},te={class:"category-header"},le={class:"pagination-container"},ae={key:1,class:"tab-disabled"},ne={__name:"HighDefenseTab",props:{protectionId:{type:[Number,String],required:!0},protectionData:{type:Object,required:!0}},emits:["update"],setup(L,{emit:D}){const c=L,N=D,n=M({enabled:!1,level:"medium",mode:"detect",rules:[]}),v=b(1),g=b(10),k=b(0),i=b([{ruleId:"1070020113",ruleName:"远程命令执行漏洞",threatLevel:"高",cveId:"-",attackType:"命令注入",enabled:!0},{ruleId:"1010010020",ruleName:"SQL注入-SQL注入攻击-3",threatLevel:"高",cveId:"-",attackType:"SQL注入",enabled:!0},{ruleId:"1060050015",ruleName:"XSS攻击检测：htaccess文",threatLevel:"高",cveId:"-",attackType:"webshell上传",enabled:!0},{ruleId:"1040010673",ruleName:"可疑的数字字符串：Null2ing",threatLevel:"高",cveId:"-",attackType:"跨站脚本攻击",enabled:!0},{ruleId:"1040010336",ruleName:"XSS攻击检测：video poster",threatLevel:"严重",cveId:"-",attackType:"跨站脚本攻击",enabled:!0},{ruleId:"1050010011",ruleName:"Apache HTTP服务器mod_proxy",threatLevel:"严重",cveId:"CVE-2021-40438",attackType:"远程代码执行",enabled:!0},{ruleId:"1080030112",ruleName:'访问敏感文件："/proc/tty/d"',threatLevel:"高",cveId:"-",attackType:"核心文件非法访问",enabled:!0},{ruleId:"1050010042",ruleName:"Apache Tika Tesseract组件",threatLevel:"高",cveId:"CVE-2018-1335",attackType:"命令执行漏洞",enabled:!0}]),S=()=>{if(c.protectionData&&c.protectionData.securityConfig&&c.protectionData.securityConfig.highDefense){const l=c.protectionData.securityConfig.highDefense;n.enabled=l.enabled||!1,n.level=l.level||"medium",n.mode=l.mode||"detect",l.rules&&Array.isArray(l.rules)&&l.rules.forEach(e=>{const m=i.value.find(f=>f.ruleId===e.ruleId);m&&(m.enabled=e.enabled)})}},x=l=>{n.enabled=l,p()},z=l=>{n.level=l,p()},A=l=>{n.mode=l,p()},U=(l,e)=>{l.enabled=e,p()},E=()=>{i.value.forEach(l=>{l.enabled=!0}),p()},P=()=>{i.value.forEach(l=>{l.enabled=!1}),p()},R=l=>{g.value=l},Q=l=>{v.value=l},B=l=>({高:"danger",中:"warning",低:"info",严重:"error"})[l]||"info",p=()=>{const l={enabled:n.enabled,level:n.level,mode:n.mode,rules:i.value.map(e=>({ruleId:e.ruleId,enabled:e.enabled}))};N("update","highDefense",l)};return F(()=>c.protectionData,()=>{S()},{deep:!0}),G(()=>{S(),k.value=i.value.length}),(l,e)=>{const m=d("el-switch"),f=d("el-divider"),h=d("el-radio-button"),T=d("el-radio-group"),V=d("el-form-item"),w=d("el-radio"),H=d("el-form"),_=d("el-button"),u=d("el-table-column"),O=d("el-tag"),W=d("el-table"),X=d("el-pagination"),j=d("el-empty");return I(),C("div",K,[s("div",Y,[e[5]||(e[5]=s("div",{class:"tab-title"},[s("h3",null,"高防防护"),s("p",{class:"tab-description"}," 基于中国电信云安全WAF安全防护能力的OWASP TOP10安全防护，包括XSS、SQL注入，目录遍历等Web安全防护 ")],-1)),s("div",Z,[t(m,{modelValue:n.enabled,"onUpdate:modelValue":e[0]||(e[0]=o=>n.enabled=o),"active-text":"启用","inactive-text":"禁用",onChange:x},null,8,["modelValue"])])]),t(f),n.enabled?(I(),C("div",$,[t(H,{model:n,"label-width":"120px"},{default:a(()=>[t(V,{label:"防护等级"},{default:a(()=>[t(T,{modelValue:n.level,"onUpdate:modelValue":e[1]||(e[1]=o=>n.level=o),onChange:z},{default:a(()=>[t(h,{value:"low"},{default:a(()=>e[6]||(e[6]=[r("低")])),_:1,__:[6]}),t(h,{value:"medium"},{default:a(()=>e[7]||(e[7]=[r("中等")])),_:1,__:[7]}),t(h,{value:"high"},{default:a(()=>e[8]||(e[8]=[r("高")])),_:1,__:[8]})]),_:1},8,["modelValue"])]),_:1}),t(V,{label:"防护模式"},{default:a(()=>[t(T,{modelValue:n.mode,"onUpdate:modelValue":e[2]||(e[2]=o=>n.mode=o),onChange:A},{default:a(()=>[t(w,{label:"detect"},{default:a(()=>e[9]||(e[9]=[r("检测")])),_:1,__:[9]}),t(w,{label:"block"},{default:a(()=>e[10]||(e[10]=[r("拦截")])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",ee,[s("div",te,[e[13]||(e[13]=s("h4",null,"防护规则分类",-1)),t(_,{type:"primary",link:"",onClick:E},{default:a(()=>e[11]||(e[11]=[r("全选")])),_:1,__:[11]}),t(_,{type:"info",link:"",onClick:P},{default:a(()=>e[12]||(e[12]=[r("取消全选")])),_:1,__:[12]})]),t(W,{data:i.value,border:"",style:{width:"100%"}},{default:a(()=>[t(u,{label:"序号",width:"80",type:"index"}),t(u,{label:"规则ID",prop:"ruleId",width:"120"}),t(u,{label:"规则名称",prop:"ruleName","min-width":"200"}),t(u,{label:"威胁等级",width:"120"},{default:a(({row:o})=>[t(O,{type:B(o.threatLevel)},{default:a(()=>[r(J(o.threatLevel),1)]),_:2},1032,["type"])]),_:1}),t(u,{label:"CVE编号",prop:"cveId",width:"150"}),t(u,{label:"攻击类型",prop:"attackType","min-width":"150"}),t(u,{label:"状态",width:"100"},{default:a(({row:o})=>[t(m,{modelValue:o.enabled,"onUpdate:modelValue":y=>o.enabled=y,onChange:y=>U(o,y)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(u,{label:"操作",width:"150"},{default:a(({row:o})=>[t(_,{type:"primary",link:""},{default:a(()=>e[14]||(e[14]=[r("详情")])),_:1,__:[14]}),t(_,{type:"danger",link:""},{default:a(()=>e[15]||(e[15]=[r("日志")])),_:1,__:[15]})]),_:1})]),_:1},8,["data"]),s("div",le,[t(X,{"current-page":v.value,"onUpdate:currentPage":e[3]||(e[3]=o=>v.value=o),"page-size":g.value,"onUpdate:pageSize":e[4]||(e[4]=o=>g.value=o),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:k.value,onSizeChange:R,onCurrentChange:Q},null,8,["current-page","page-size","total"])])])])):(I(),C("div",ae,[t(j,{description:"高防防护功能已禁用，请先启用该功能"})]))])}}},de=q(ne,[["__scopeId","data-v-b7b51875"]]);export{de as default};
