import{_ as ce,r as A,a as m,c as ve,o as _e,b as ge,d as t,w as l,e as i,R as M,E as _,f as be,g as G,h as u,i as we,j as s,k as ke,t as D,u as H,l as J,m as ye}from"./index-BXULZXMF.js";const Ve={class:"region-management"},Ce={class:"card-header"},De={class:"search-area"},xe={class:"mt-2 flex justify-end"},Se={class:"mt-2 flex justify-end"},ze={class:"pagination-container"},Te={class:"dialog-footer"},Ue={class:"text-xs text-gray-500 mt-2"},Fe={__name:"RegionManagement",setup(Re){function K(){const o=Date.now()%1e12,e=Math.floor(Math.random()*1024),n=Math.floor(Math.random()*4096);return`LCG${o}${e.toString().padStart(3,"0")}${n.toString().padStart(4,"0")}`}const g=A({name:""}),y=m([]),z=m(!1),c=A({currentPage:1,pageSize:10,total:0}),V=m(!1),$=m(""),T=m(),U=m(!1),P=m(null),r=A({id:"",name:"",isDistributed:!1,status:"active",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),Q={name:[{required:!0,message:"请输入地域名称",trigger:"blur"}]},b=async()=>{z.value=!0;try{y.value=await M.getRegions()}catch(o){console.error("获取地域数据失败:",o),_.error("获取地域数据失败")}finally{z.value=!1}},F=m(!1),R=m(!1),w=m([]),k=m([]);function W(){w.value=[]}function X(){F.value=!1}function Y(){k.value=[]}function Z(){R.value=!1}const v=m({prop:"",order:""});function h({prop:o,order:e}){v.value={prop:o,order:e}}const ee=ve(()=>{let o=y.value;if(g.name){const e=g.name.trim().toLowerCase();o=o.filter(n=>n.name.toLowerCase().includes(e))}return w.value.length&&(o=o.filter(e=>w.value.includes(e.isDistributed))),k.value.length&&(o=o.filter(e=>k.value.includes(e.status))),v.value.prop&&v.value.order&&(o=[...o].sort((e,n)=>{let d=e[v.value.prop],p=n[v.value.prop];return(v.value.prop==="createTime"||v.value.prop==="updateTime")&&(d=new Date(d).getTime(),p=new Date(p).getTime()),v.value.order==="ascending"?d-p:p-d})),o}),j=()=>{c.currentPage=1,b()},te=()=>{Object.assign(g,{name:""}),j()},le=async()=>{$.value="新建地域",Object.assign(r,{id:"",name:"",isDistributed:!1,status:"active",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),V.value=!0},ae=async(o,e)=>{try{await M.updateRegion(o,e),_.success("编辑成功"),b()}catch(n){console.error("编辑地域失败:",n),_.error("编辑地域失败")}},oe=async o=>{try{await ye.confirm("确定要删除该地域吗？","提示",{type:"warning"}),await M.deleteRegion(o),_.success("删除成功"),b()}catch(e){e!=="cancel"&&(console.error("删除地域失败:",e),_.error("删除地域失败"))}},ne=o=>{o.status=o.status==="active"?"disabled":"active",o.updateTime=new Date().toLocaleString(),o.updateAccount="current_user";const e=o.status==="active"?"启用":"禁用";_.success(`地域已${e}`)},se=()=>{T.value.validate(o=>{if(o){const e=new Date().toLocaleString(),n="current_user";if(r.id){const d=y.value.findIndex(p=>p.id===r.id);d>-1&&Object.assign(y.value[d],{...r,updateTime:e,updateAccount:n}),_.success("编辑成功")}else{const d={...r,id:K(),createTime:e,createAccount:n,updateTime:e,updateAccount:n};y.value.push(d),c.total++,_.success("新增成功")}V.value=!1}})},ie=()=>{var o;(o=T.value)==null||o.resetFields()},re=o=>{c.pageSize=o,b()},ue=o=>{c.currentPage=o,b()};return _e(()=>{b()}),(o,e)=>{const n=i("el-button"),d=i("el-input"),p=i("el-form-item"),E=i("el-form"),f=i("el-table-column"),x=i("el-checkbox"),I=i("el-checkbox-group"),B=i("el-icon"),L=i("el-popover"),q=i("el-tag"),de=i("el-table"),pe=i("el-pagination"),me=i("el-card"),S=i("el-radio"),N=i("el-radio-group"),O=i("el-dialog"),fe=be("loading");return G(),ge("div",Ve,[t(me,{class:"box-card"},{header:l(()=>[u("div",Ce,[e[16]||(e[16]=u("span",null,"地域管理",-1)),t(n,{type:"primary",onClick:le},{default:l(()=>e[15]||(e[15]=[s("新建地域")])),_:1,__:[15]})])]),default:l(()=>[u("div",De,[t(E,{inline:!0,model:g,class:"search-form"},{default:l(()=>[t(p,{label:"名称"},{default:l(()=>[t(d,{modelValue:g.name,"onUpdate:modelValue":e[0]||(e[0]=a=>g.name=a),placeholder:"请输入地域名称",clearable:""},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(n,{type:"primary",onClick:j},{default:l(()=>e[17]||(e[17]=[s("搜索")])),_:1,__:[17]}),t(n,{onClick:te},{default:l(()=>e[18]||(e[18]=[s("重置")])),_:1,__:[18]})]),_:1})]),_:1},8,["model"])]),we((G(),ke(de,{data:ee.value,style:{width:"100%"},border:"",stripe:"",onSortChange:h},{default:l(()=>[t(f,{prop:"id",label:"ID",width:"220",fixed:"left"}),t(f,{prop:"name",label:"名称",width:"120"}),t(f,{prop:"isDistributed",label:"是否分布式",width:"120"},{header:l(()=>[e[23]||(e[23]=u("span",null,"是否分布式",-1)),t(L,{placement:"bottom",width:"160",trigger:"click",visible:F.value,"onUpdate:visible":e[2]||(e[2]=a=>F.value=a)},{reference:l(()=>[t(B,{color:w.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:l(()=>[t(H(J))]),_:1},8,["color"])]),default:l(()=>[u("div",null,[t(I,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a)},{default:l(()=>[t(x,{label:!0},{default:l(()=>e[19]||(e[19]=[s("是")])),_:1,__:[19]}),t(x,{label:!1},{default:l(()=>e[20]||(e[20]=[s("否")])),_:1,__:[20]})]),_:1},8,["modelValue"]),u("div",xe,[t(n,{size:"small",onClick:W},{default:l(()=>e[21]||(e[21]=[s("重置")])),_:1,__:[21]}),t(n,{size:"small",type:"primary",onClick:X},{default:l(()=>e[22]||(e[22]=[s("确定")])),_:1,__:[22]})])])]),_:1},8,["visible"])]),default:l(a=>[t(q,{type:a.row.isDistributed?"success":"info"},{default:l(()=>[s(D(a.row.isDistributed?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"status",label:"状态",width:"100"},{header:l(()=>[e[28]||(e[28]=u("span",null,"状态",-1)),t(L,{placement:"bottom",width:"160",trigger:"click",visible:R.value,"onUpdate:visible":e[4]||(e[4]=a=>R.value=a)},{reference:l(()=>[t(B,{color:k.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:l(()=>[t(H(J))]),_:1},8,["color"])]),default:l(()=>[u("div",null,[t(I,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=a=>k.value=a)},{default:l(()=>[t(x,{label:"active"},{default:l(()=>e[24]||(e[24]=[s("启用")])),_:1,__:[24]}),t(x,{label:"disabled"},{default:l(()=>e[25]||(e[25]=[s("禁用")])),_:1,__:[25]})]),_:1},8,["modelValue"]),u("div",Se,[t(n,{size:"small",onClick:Y},{default:l(()=>e[26]||(e[26]=[s("重置")])),_:1,__:[26]}),t(n,{size:"small",type:"primary",onClick:Z},{default:l(()=>e[27]||(e[27]=[s("确定")])),_:1,__:[27]})])])]),_:1},8,["visible"])]),default:l(a=>[t(q,{type:a.row.status==="active"?"success":"danger"},{default:l(()=>[s(D(a.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"remark",label:"备注",width:"200","show-overflow-tooltip":""}),t(f,{prop:"createTime",label:"添加时间",width:"160",sortable:"custom"}),t(f,{prop:"createAccount",label:"添加账号",width:"120"}),t(f,{prop:"updateTime",label:"最后修改时间",width:"160",sortable:"custom"}),t(f,{prop:"updateAccount",label:"最后修改账号",width:"120"}),t(f,{label:"操作",width:"200",fixed:"right"},{default:l(a=>[t(n,{type:"primary",link:"",size:"small",onClick:C=>ae(a.row.id,a.row)},{default:l(()=>e[29]||(e[29]=[s("编辑")])),_:2,__:[29]},1032,["onClick"]),t(n,{type:a.row.status==="active"?"danger":"success",link:"",size:"small",onClick:C=>ne(a.row)},{default:l(()=>[s(D(a.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(n,{type:"danger",link:"",size:"small",onClick:C=>oe(a.row.id)},{default:l(()=>e[30]||(e[30]=[s("删除")])),_:2,__:[30]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[fe,z.value]]),u("div",ze,[t(pe,{"current-page":c.currentPage,"onUpdate:currentPage":e[5]||(e[5]=a=>c.currentPage=a),"page-size":c.pageSize,"onUpdate:pageSize":e[6]||(e[6]=a=>c.pageSize=a),"page-sizes":[10,20,50,100],total:c.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:re,onCurrentChange:ue},null,8,["current-page","page-size","total"])])]),_:1}),t(O,{modelValue:V.value,"onUpdate:modelValue":e[12]||(e[12]=a=>V.value=a),title:$.value,width:"500px",onClose:ie},{footer:l(()=>[u("span",Te,[t(n,{onClick:e[11]||(e[11]=a=>V.value=!1)},{default:l(()=>e[35]||(e[35]=[s("取消")])),_:1,__:[35]}),t(n,{type:"primary",onClick:se},{default:l(()=>e[36]||(e[36]=[s("确定")])),_:1,__:[36]})])]),default:l(()=>[t(E,{model:r,rules:Q,ref_key:"formRef",ref:T,"label-width":"120px"},{default:l(()=>[t(p,{label:"名称",prop:"name"},{default:l(()=>[t(d,{modelValue:r.name,"onUpdate:modelValue":e[7]||(e[7]=a=>r.name=a),placeholder:"请输入地域名称"},null,8,["modelValue"])]),_:1}),t(p,{label:"是否分布式",prop:"isDistributed"},{default:l(()=>[t(N,{modelValue:r.isDistributed,"onUpdate:modelValue":e[8]||(e[8]=a=>r.isDistributed=a)},{default:l(()=>[t(S,{value:!0},{default:l(()=>e[31]||(e[31]=[s("是")])),_:1,__:[31]}),t(S,{value:!1},{default:l(()=>e[32]||(e[32]=[s("否")])),_:1,__:[32]})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"状态",prop:"status"},{default:l(()=>[t(N,{modelValue:r.status,"onUpdate:modelValue":e[9]||(e[9]=a=>r.status=a)},{default:l(()=>[t(S,{label:"active"},{default:l(()=>e[33]||(e[33]=[s("启用")])),_:1,__:[33]}),t(S,{label:"disabled"},{default:l(()=>e[34]||(e[34]=[s("禁用")])),_:1,__:[34]})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"备注",prop:"remark"},{default:l(()=>[t(d,{modelValue:r.remark,"onUpdate:modelValue":e[10]||(e[10]=a=>r.remark=a),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(O,{modelValue:U.value,"onUpdate:modelValue":e[14]||(e[14]=a=>U.value=a),title:"确认删除",width:"400px"},{footer:l(()=>[t(n,{onClick:e[13]||(e[13]=a=>U.value=!1)},{default:l(()=>e[39]||(e[39]=[s("取消")])),_:1,__:[39]}),t(n,{type:"danger",onClick:o.confirmDelete},{default:l(()=>e[40]||(e[40]=[s("确认删除")])),_:1,__:[40]},8,["onClick"])]),default:l(()=>{var a,C;return[u("div",null,[e[37]||(e[37]=s("确定要删除地域 ")),u("b",null,D((a=P.value)==null?void 0:a.name),1),e[38]||(e[38]=s(" 吗？"))]),u("div",Ue,"ID: "+D((C=P.value)==null?void 0:C.id),1)]}),_:1},8,["modelValue"])])}}},Me=ce(Fe,[["__scopeId","data-v-c9e83c15"]]);export{Me as default};
