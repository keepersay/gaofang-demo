import{_ as fe,r as B,a as v,c as L,o as ge,b as ve,d as t,w as a,e as d,R as j,f as _e,g as K,h as f,i as be,j as we,k as i,l as ye,t as x,u as ke,m as Ce,E as k}from"./index-5Szv_YkU.js";function Ve(){const I=Date.now()%1e12,s=Math.floor(Math.random()*1024),g=Math.floor(Math.random()*4096);return`DC${I}${s.toString().padStart(3,"0")}${g.toString().padStart(4,"0")}`}const b=[{id:"DC202401010001",name:"北京机房01",regionId:"PEK",status:"active",contactPerson:"张三",contactPhone:"13800138001",contactEmail:"zhangsan@example.com",remark:"北京地区核心机房",createTime:"2024-01-01 09:00:00",createAccount:"admin",updateTime:"2024-01-01 09:00:00",updateAccount:"admin"},{id:"DC202401010002",name:"上海机房01",regionId:"SHA",status:"active",contactPerson:"李四",contactPhone:"13800138002",contactEmail:"lisi@example.com",remark:"上海地区核心机房",createTime:"2024-01-02 10:00:00",createAccount:"admin",updateTime:"2024-01-02 10:00:00",updateAccount:"admin"},{id:"DC202401010003",name:"广州机房01",regionId:"CAN",status:"active",contactPerson:"王五",contactPhone:"13800138003",contactEmail:"wangwu@example.com",remark:"广州地区核心机房",createTime:"2024-01-03 11:00:00",createAccount:"admin",updateTime:"2024-01-03 11:00:00",updateAccount:"admin"},{id:"DC202401010004",name:"无锡机房01",regionId:"WUX",status:"disabled",contactPerson:"赵六",contactPhone:"13800138004",contactEmail:"zhaoliu@example.com",remark:"无锡地区备用机房",createTime:"2024-01-04 12:00:00",createAccount:"admin",updateTime:"2024-01-04 12:00:00",updateAccount:"admin"}];class P{static async getDataCenters(){return new Promise(s=>{setTimeout(()=>{s(b)},300)})}static async getDataCenterById(s){return new Promise((g,u)=>{setTimeout(()=>{const c=b.find(C=>C.id===s);c?g(c):u(new Error("机房不存在"))},100)})}static async addDataCenter(s){return new Promise(g=>{setTimeout(()=>{const u={...s,id:Ve(),createTime:new Date().toLocaleString(),createAccount:"current_user",updateTime:new Date().toLocaleString(),updateAccount:"current_user"};b.push(u),g(u)},300)})}static async updateDataCenter(s,g){return new Promise(u=>{setTimeout(()=>{const c=b.findIndex(C=>C.id===s);c>-1?(b[c]={...b[c],...g,updateTime:new Date().toLocaleString(),updateAccount:"current_user"},u(b[c])):u(null)},300)})}static async deleteDataCenter(s){return new Promise(g=>{setTimeout(()=>{const u=b.findIndex(c=>c.id===s);u>-1&&b.splice(u,1),g({success:!0})},300)})}}const xe={class:"datacenter-management"},De={class:"card-header"},he={class:"search-area"},Pe={class:"ellipsis-cell"},Te={class:"ellipsis-cell"},Ie={class:"mt-2 flex justify-end"},Ee={class:"dialog-footer"},Ae={class:"text-xs text-gray-500 mt-2"},Se={__name:"DataCenterManagement",setup(I){const s=B({name:""}),g=v([]),u=v(!1),c=v(!1),C=v([]),R=v([]),V=v(!1),E=v(),D=v(!1),T=v(null),n=B({id:"",name:"",regionId:"",status:"active",contactPerson:"",contactPhone:"",contactEmail:"",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),O={name:[{required:!0,message:"请输入机房名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],regionId:[{required:!0,message:"请选择地域",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],contactPerson:[{required:!1,message:"请输入联系人",trigger:"blur"}],contactPhone:[{required:!1,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],contactEmail:[{required:!1,message:"请输入联系邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},A=v(!1),w=v([]),y=v({prop:"",order:""});function H(){w.value=[]}function W(){A.value=!1}const X=L(()=>R.value),G=async()=>{try{R.value=await j.getRegionTree(),C.value=await j.getRegions()}catch(o){console.error("获取地域数据失败:",o)}},$=o=>{const e=C.value.find(r=>r.id===o);return e?e.name:o},S=async()=>{u.value=!0;try{g.value=await P.getDataCenters(),u.value=!1}catch(o){console.error("获取机房数据失败:",o),u.value=!1}},J=L(()=>{let o=g.value;if(s.name){const e=s.name.toLowerCase();o=o.filter(r=>r.name.toLowerCase().includes(e))}return w.value.length&&(o=o.filter(e=>w.value.includes(e.status))),y.value.prop&&y.value.order&&(o=[...o].sort((e,r)=>{let _=e[y.value.prop],m=r[y.value.prop];return(y.value.prop==="createTime"||y.value.prop==="updateTime")&&(_=new Date(_).getTime(),m=new Date(m).getTime()),y.value.order==="ascending"?_>m?1:-1:_<m?1:-1})),o}),U=()=>{console.log("搜索:",s)},Q=()=>{s.name="",w.value=[],U()},Y=async()=>{c.value=!1,Object.assign(n,{id:"",name:"",regionId:"",status:"active",contactPerson:"",contactPhone:"",contactEmail:"",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),V.value=!0},Z=o=>{c.value=!0,Object.assign(n,{id:o.id,name:o.name,regionId:o.regionId,status:o.status,contactPerson:o.contactPerson,contactPhone:o.contactPhone,contactEmail:o.contactEmail,remark:o.remark}),V.value=!0},ee=o=>{T.value=o,D.value=!0},te=async()=>{try{await P.deleteDataCenter(T.value.id),k.success("删除成功"),S()}catch(o){console.error("删除机房失败:",o),k.error("删除机房失败")}D.value=!1},ae=async o=>{const e=o.status==="active"?"disabled":"active";try{await P.updateDataCenter(o.id,{status:e}),o.status=e,k.success(`机房已${e==="active"?"启用":"禁用"}`)}catch(r){console.error("更新机房状态失败:",r),k.error("更新机房状态失败")}},le=async()=>{E.value.validate(async o=>{if(o)try{c.value?(await P.updateDataCenter(n.id,n),k.success("编辑成功")):(await P.addDataCenter(n),k.success("新增成功")),V.value=!1,S()}catch(e){console.error("提交表单失败:",e),k.error("提交表单失败")}})},oe=()=>{var o;(o=E.value)==null||o.resetFields()};return ge(async()=>{await G(),await S()}),(o,e)=>{const r=d("el-button"),_=d("el-input"),m=d("el-form-item"),z=d("el-form"),p=d("el-table-column"),M=d("el-tooltip"),q=d("el-checkbox"),ne=d("el-checkbox-group"),re=d("el-icon"),se=d("el-popover"),ie=d("el-tag"),de=d("el-table"),ue=d("el-card"),ce=d("el-cascader"),F=d("el-radio"),me=d("el-radio-group"),N=d("el-dialog"),pe=_e("loading");return K(),ve("div",xe,[t(ue,{class:"box-card"},{header:a(()=>[f("div",De,[e[15]||(e[15]=f("span",null,"机房管理",-1)),t(r,{type:"primary",onClick:Y},{default:a(()=>e[14]||(e[14]=[i("新建机房")])),_:1,__:[14]})])]),default:a(()=>[f("div",he,[t(z,{inline:!0,model:s},{default:a(()=>[t(m,{label:"名称"},{default:a(()=>[t(_,{modelValue:s.name,"onUpdate:modelValue":e[0]||(e[0]=l=>s.name=l),placeholder:"请输入机房名称",clearable:"",style:{"max-width":"260px"},onKeyup:we(U,["enter"])},null,8,["modelValue"])]),_:1}),t(m,null,{default:a(()=>[t(r,{type:"primary",onClick:U},{default:a(()=>e[16]||(e[16]=[i("搜索")])),_:1,__:[16]}),t(r,{onClick:Q},{default:a(()=>e[17]||(e[17]=[i("重置")])),_:1,__:[17]})]),_:1})]),_:1},8,["model"])]),be((K(),ye(de,{data:J.value,style:{width:"100%","min-height":"500px","margin-top":"20px"},border:"",stripe:"","max-height":"700","header-cell-style":{position:"sticky",top:0,background:"#fff",zIndex:2},"row-class-name":"dense-row"},{empty:a(()=>e[25]||(e[25]=[f("div",{class:"text-gray-400 py-10 text-center"},"暂无数据",-1)])),default:a(()=>[t(p,{prop:"id",label:"ID",width:"180",fixed:"left"}),t(p,{prop:"name",label:"名称",width:"150"},{default:a(l=>[t(M,{effect:"dark",content:l.row.name,placement:"top"},{default:a(()=>[f("span",Pe,x(l.row.name),1)]),_:2},1032,["content"])]),_:1}),t(p,{prop:"regionId",label:"地域",width:"120"},{default:a(l=>[t(M,{effect:"dark",content:$(l.row.regionId),placement:"top"},{default:a(()=>[f("span",Te,x($(l.row.regionId)),1)]),_:2},1032,["content"])]),_:1}),t(p,{prop:"status",label:"状态",width:"100"},{header:a(()=>[e[22]||(e[22]=f("span",null,"状态",-1)),t(se,{placement:"bottom",width:"160",trigger:"click",visible:A.value,"onUpdate:visible":e[2]||(e[2]=l=>A.value=l)},{reference:a(()=>[t(re,{color:w.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:a(()=>[t(ke(Ce))]),_:1},8,["color"])]),default:a(()=>[f("div",null,[t(ne,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=l=>w.value=l)},{default:a(()=>[t(q,{label:"active"},{default:a(()=>e[18]||(e[18]=[i("启用")])),_:1,__:[18]}),t(q,{label:"disabled"},{default:a(()=>e[19]||(e[19]=[i("禁用")])),_:1,__:[19]})]),_:1},8,["modelValue"]),f("div",Ie,[t(r,{size:"small",onClick:H},{default:a(()=>e[20]||(e[20]=[i("重置")])),_:1,__:[20]}),t(r,{size:"small",type:"primary",onClick:W},{default:a(()=>e[21]||(e[21]=[i("确定")])),_:1,__:[21]})])])]),_:1},8,["visible"])]),default:a(l=>[t(ie,{type:l.row.status==="active"?"success":"danger"},{default:a(()=>[i(x(l.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(p,{prop:"contactPerson",label:"联系人",width:"120"}),t(p,{prop:"contactPhone",label:"联系电话",width:"140"}),t(p,{prop:"contactEmail",label:"联系邮箱",width:"180"}),t(p,{prop:"remark",label:"备注","min-width":"200","show-overflow-tooltip":""}),t(p,{prop:"createTime",label:"创建时间",width:"160",sortable:""}),t(p,{prop:"createAccount",label:"创建人",width:"120"}),t(p,{prop:"updateTime",label:"修改时间",width:"160",sortable:""}),t(p,{prop:"updateAccount",label:"修改人",width:"120"}),t(p,{label:"操作",width:"180",fixed:"right"},{default:a(l=>[t(r,{type:"primary",link:"",size:"small",onClick:h=>Z(l.row)},{default:a(()=>e[23]||(e[23]=[i("编辑")])),_:2,__:[23]},1032,["onClick"]),t(r,{type:l.row.status==="active"?"danger":"success",link:"",size:"small",onClick:h=>ae(l.row)},{default:a(()=>[i(x(l.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(r,{type:"danger",link:"",size:"small",onClick:h=>ee(l.row)},{default:a(()=>e[24]||(e[24]=[i("删除")])),_:2,__:[24]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,u.value]])]),_:1}),t(N,{modelValue:V.value,"onUpdate:modelValue":e[11]||(e[11]=l=>V.value=l),title:c.value?"编辑机房":"新建机房",width:"600px","close-on-click-modal":!1,onClose:oe},{footer:a(()=>[f("span",Ee,[t(r,{onClick:e[10]||(e[10]=l=>V.value=!1)},{default:a(()=>e[28]||(e[28]=[i("取消")])),_:1,__:[28]}),t(r,{type:"primary",onClick:le},{default:a(()=>e[29]||(e[29]=[i("确定")])),_:1,__:[29]})])]),default:a(()=>[t(z,{model:n,rules:O,ref_key:"formRef",ref:E,"label-width":"100px"},{default:a(()=>[t(m,{label:"名称",prop:"name"},{default:a(()=>[t(_,{modelValue:n.name,"onUpdate:modelValue":e[3]||(e[3]=l=>n.name=l),placeholder:"请输入机房名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"地域",prop:"regionId"},{default:a(()=>[t(ce,{modelValue:n.regionId,"onUpdate:modelValue":e[4]||(e[4]=l=>n.regionId=l),options:X.value,props:{checkStrictly:!0,value:"id",label:"name",emitPath:!1,expandTrigger:"hover"},placeholder:"请选择地域",clearable:"",style:{width:"100%"}},null,8,["modelValue","options"])]),_:1}),t(m,{label:"状态",prop:"status"},{default:a(()=>[t(me,{modelValue:n.status,"onUpdate:modelValue":e[5]||(e[5]=l=>n.status=l)},{default:a(()=>[t(F,{label:"active"},{default:a(()=>e[26]||(e[26]=[i("启用")])),_:1,__:[26]}),t(F,{label:"disabled"},{default:a(()=>e[27]||(e[27]=[i("禁用")])),_:1,__:[27]})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"联系人",prop:"contactPerson"},{default:a(()=>[t(_,{modelValue:n.contactPerson,"onUpdate:modelValue":e[6]||(e[6]=l=>n.contactPerson=l),placeholder:"请输入联系人姓名"},null,8,["modelValue"])]),_:1}),t(m,{label:"联系电话",prop:"contactPhone"},{default:a(()=>[t(_,{modelValue:n.contactPhone,"onUpdate:modelValue":e[7]||(e[7]=l=>n.contactPhone=l),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),t(m,{label:"联系邮箱",prop:"contactEmail"},{default:a(()=>[t(_,{modelValue:n.contactEmail,"onUpdate:modelValue":e[8]||(e[8]=l=>n.contactEmail=l),placeholder:"请输入联系邮箱"},null,8,["modelValue"])]),_:1}),t(m,{label:"备注",prop:"remark"},{default:a(()=>[t(_,{modelValue:n.remark,"onUpdate:modelValue":e[9]||(e[9]=l=>n.remark=l),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(N,{modelValue:D.value,"onUpdate:modelValue":e[13]||(e[13]=l=>D.value=l),title:"确认删除",width:"400px"},{footer:a(()=>[t(r,{onClick:e[12]||(e[12]=l=>D.value=!1)},{default:a(()=>e[32]||(e[32]=[i("取消")])),_:1,__:[32]}),t(r,{type:"danger",onClick:te},{default:a(()=>e[33]||(e[33]=[i("确认删除")])),_:1,__:[33]})]),default:a(()=>{var l,h;return[f("div",null,[e[30]||(e[30]=i("确定要删除机房 ")),f("b",null,x((l=T.value)==null?void 0:l.name),1),e[31]||(e[31]=i(" 吗？"))]),f("div",Ae,"ID: "+x((h=T.value)==null?void 0:h.id),1)]}),_:1},8,["modelValue"])])}}},Re=fe(Se,[["__scopeId","data-v-c5d6966d"]]);export{Re as default};
