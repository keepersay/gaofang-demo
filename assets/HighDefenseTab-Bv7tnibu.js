import{_ as P,r as T,a as g,c as M,n as O,o as X,f as s,b as F,d as J,h as i,J as G,e as a,w as d,k as m,t as K}from"./index-BVji5qTU.js";const W={class:"high-defense-tab"},Y={class:"protection-status"},Z={class:"search-area"},$={class:"search-form"},ee={class:"search-buttons"},le={class:"protection-mode-group"},ae={class:"pagination-container"},te={__name:"HighDefenseTab",props:{protectionId:{type:[Number,String],required:!0},protectionData:{type:Object,required:!0}},emits:["update"],setup(L,{emit:z}){const v=L,N=z,n=T({enabled:!0,level:"medium",mode:"warn",rules:[]}),o=T({ruleId:"",ruleName:"",attackType:"",cveId:"",threatLevel:""}),b=g(1),h=g(10),I=g(0),f=g([{ruleId:"1070020113",ruleName:"远程命令执行漏洞",threatLevel:"高",cveId:"-",attackType:"命令注入",effectDescription:"木马型代码注入",enabled:!0,mode:"warn"},{ruleId:"1010010020",ruleName:"SQL注入-SQL注入攻击-3",threatLevel:"高",cveId:"-",attackType:"SQL注入",effectDescription:"SQL注入",enabled:!0,mode:"warn"},{ruleId:"1060050015",ruleName:"XSS攻击检测：htaccess文",threatLevel:"高",cveId:"-",attackType:"webshell上传",effectDescription:"webshell上传",enabled:!0,mode:"warn"},{ruleId:"1040010673",ruleName:"可疑的数字字符串：Null2ing",threatLevel:"高",cveId:"-",attackType:"跨站脚本攻击",effectDescription:"跨站脚本攻击",enabled:!0,mode:"warn"},{ruleId:"1040010336",ruleName:"XSS攻击检测：video poster",threatLevel:"严重",cveId:"-",attackType:"跨站脚本攻击",effectDescription:"跨站脚本攻击",enabled:!0,mode:"block"},{ruleId:"1050010011",ruleName:"Apache HTTP服务器mod_proxy",threatLevel:"严重",cveId:"CVE-2021-40438",attackType:"远程代码执行",effectDescription:"远程代码执行漏洞",enabled:!0,mode:"block"},{ruleId:"1080030112",ruleName:'访问敏感文件："/proc/tty/d"',threatLevel:"高",cveId:"-",attackType:"核心文件非法访问",effectDescription:"核心文件非法访问",enabled:!0,mode:"warn"},{ruleId:"1050010042",ruleName:"Apache Tika Tesseract组件",threatLevel:"高",cveId:"CVE-2018-1335",attackType:"命令执行漏洞",effectDescription:"命令执行漏洞",enabled:!0,mode:"warn"}]),S=M(()=>{let l=[...f.value];return o.ruleId&&(l=l.filter(e=>e.ruleId.includes(o.ruleId))),o.ruleName&&(l=l.filter(e=>e.ruleName.includes(o.ruleName))),o.attackType&&(l=l.filter(e=>e.attackType===o.attackType)),o.cveId&&(l=l.filter(e=>e.cveId.includes(o.cveId))),o.threatLevel&&(l=l.filter(e=>e.threatLevel===o.threatLevel)),l}),V=()=>{if(v.protectionData&&v.protectionData.securityConfig&&v.protectionData.securityConfig.highDefense){const l=v.protectionData.securityConfig.highDefense;n.enabled=l.enabled||!0,n.level=l.level||"medium",n.mode=l.mode||"warn",(n.mode==="detect"||n.mode==="monitor")&&(n.mode="warn"),l.rules&&Array.isArray(l.rules)&&l.rules.forEach(e=>{const r=f.value.find(_=>_.ruleId===e.ruleId);r&&(r.enabled=e.enabled,e.mode==="detect"||e.mode==="monitor"?r.mode="warn":e.mode==="block"?r.mode="block":r.mode=e.mode||"warn")})}},U=l=>{n.mode=l,f.value.forEach(e=>{e.mode=l}),w()},x=(l,e)=>{l.enabled=e,w()},k=()=>{b.value=1},E=()=>{Object.keys(o).forEach(l=>{o[l]=""}),k()},Q=l=>{h.value=l},q=l=>{b.value=l},A=l=>({高:"danger",中:"warning",低:"info",严重:"danger"})[l]||"info",w=()=>{const l={enabled:n.enabled,level:n.level,mode:n.mode,rules:f.value.map(e=>({ruleId:e.ruleId,enabled:e.enabled,mode:e.mode}))};N("update","highDefense",l)};return O(()=>v.protectionData,()=>{V()},{deep:!0}),X(()=>{V(),I.value=f.value.length}),(l,e)=>{const r=s("el-radio"),_=s("el-radio-group"),y=s("el-input"),u=s("el-option"),C=s("el-select"),D=s("el-button"),c=s("el-table-column"),R=s("el-tag"),j=s("el-switch"),B=s("el-table"),H=s("el-pagination");return J(),F("div",W,[e[15]||(e[15]=i("div",{class:"tab-header"},[i("div",{class:"tab-title"},[i("h3",null,"高防防护")])],-1)),i("div",Y,[e[10]||(e[10]=i("span",{class:"status-label"},"防护模式：",-1)),a(_,{modelValue:n.mode,"onUpdate:modelValue":e[0]||(e[0]=t=>n.mode=t),onChange:U,size:"small"},{default:d(()=>[a(r,{label:"warn"},{default:d(()=>[...e[8]||(e[8]=[m("预警",-1)])]),_:1}),a(r,{label:"block"},{default:d(()=>[...e[9]||(e[9]=[m("阻断",-1)])]),_:1})]),_:1},8,["modelValue"])]),e[16]||(e[16]=G('<div class="protection-stats" data-v-09cd1342><div class="stats-text" data-v-09cd1342>已匹配到攻击规则数量：<span class="stats-value" data-v-09cd1342>6</span>，拦截数量：<span class="stats-value" data-v-09cd1342>2</span>，告警数量：<span class="stats-value" data-v-09cd1342>4</span>（防护模式为&quot;预警&quot;时不会阻断）</div></div><div class="protection-level" data-v-09cd1342><span class="level-label" data-v-09cd1342>防护等级：</span><span class="level-value" data-v-09cd1342>中等</span></div>',2)),i("div",Z,[i("div",$,[a(y,{placeholder:"输入规则ID",modelValue:o.ruleId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.ruleId=t),size:"small"},null,8,["modelValue"]),a(y,{placeholder:"输入规则名称",modelValue:o.ruleName,"onUpdate:modelValue":e[2]||(e[2]=t=>o.ruleName=t),size:"small"},null,8,["modelValue"]),a(C,{modelValue:o.attackType,"onUpdate:modelValue":e[3]||(e[3]=t=>o.attackType=t),placeholder:"攻击类型筛选",clearable:"",size:"small"},{default:d(()=>[a(u,{label:"全部",value:""}),a(u,{label:"SQL注入",value:"SQL注入"}),a(u,{label:"跨站脚本攻击",value:"跨站脚本攻击"}),a(u,{label:"命令注入",value:"命令注入"})]),_:1},8,["modelValue"]),a(y,{placeholder:"输入CVE编号",modelValue:o.cveId,"onUpdate:modelValue":e[4]||(e[4]=t=>o.cveId=t),size:"small"},null,8,["modelValue"]),a(C,{modelValue:o.threatLevel,"onUpdate:modelValue":e[5]||(e[5]=t=>o.threatLevel=t),placeholder:"威胁等级筛选",clearable:"",size:"small"},{default:d(()=>[a(u,{label:"全部",value:""}),a(u,{label:"严重",value:"严重"}),a(u,{label:"高",value:"高"}),a(u,{label:"中",value:"中"}),a(u,{label:"低",value:"低"})]),_:1},8,["modelValue"]),i("div",ee,[a(D,{type:"primary",onClick:k,size:"small"},{default:d(()=>[...e[11]||(e[11]=[m("搜索",-1)])]),_:1}),a(D,{onClick:E,size:"small"},{default:d(()=>[...e[12]||(e[12]=[m("重置",-1)])]),_:1})])])]),a(B,{data:S.value,border:"",style:{width:"100%"},size:"small","header-cell-style":{padding:"2px 0"},"cell-style":{padding:"1px 0"}},{default:d(()=>[a(c,{label:"序号",width:"50",type:"index",align:"center"}),a(c,{label:"规则ID",prop:"ruleId",width:"90",align:"center"}),a(c,{label:"规则名称",prop:"ruleName","min-width":"160"}),a(c,{label:"威胁等级",width:"70",align:"center"},{default:d(({row:t})=>[a(R,{type:A(t.threatLevel),size:"small"},{default:d(()=>[m(K(t.threatLevel),1)]),_:2},1032,["type"])]),_:1}),a(c,{label:"高危编号",prop:"cveId",width:"110",align:"center"}),a(c,{label:"攻击类型",prop:"attackType",width:"110"}),a(c,{label:"效果说明",prop:"effectDescription","min-width":"110"}),a(c,{label:"状态",width:"60",align:"center"},{default:d(({row:t})=>[a(j,{modelValue:t.enabled,"onUpdate:modelValue":p=>t.enabled=p,onChange:p=>x(t,p),size:"small"},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(c,{label:"防护模式",width:"120",align:"center"},{default:d(({row:t})=>[i("div",le,[a(r,{modelValue:t.mode,"onUpdate:modelValue":p=>t.mode=p,label:"warn",size:"small"},{default:d(()=>[...e[13]||(e[13]=[m("预警",-1)])]),_:1},8,["modelValue","onUpdate:modelValue"]),a(r,{modelValue:t.mode,"onUpdate:modelValue":p=>t.mode=p,label:"block",size:"small"},{default:d(()=>[...e[14]||(e[14]=[m("阻断",-1)])]),_:1},8,["modelValue","onUpdate:modelValue"])])]),_:1})]),_:1},8,["data"]),i("div",ae,[a(H,{"current-page":b.value,"onUpdate:currentPage":e[6]||(e[6]=t=>b.value=t),"page-size":h.value,"onUpdate:pageSize":e[7]||(e[7]=t=>h.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:I.value,onSizeChange:Q,onCurrentChange:q,small:""},null,8,["current-page","page-size","total"])])])}}},de=P(te,[["__scopeId","data-v-09cd1342"]]);export{de as default};
