import{_ as be,r as F,a as r,c as ke,o as ye,b as we,d as t,w as l,e as u,f as Ce,g as B,h as d,i as xe,j as Ve,k as s,l as Se,t as k,u as Ae,m as Te,E as x}from"./index-CqQjMPUQ.js";const ze={class:"role-management"},he={class:"card-header"},De={class:"search-area"},Ue={class:"ellipsis-cell"},$e={class:"ellipsis-cell"},Ie={class:"mt-2 flex justify-end"},Pe={class:"pagination-container"},Fe={class:"dialog-footer"},Re={class:"text-xs text-gray-500 mt-2"},q="role-management-page-size",Ee={__name:"RoleManagement",setup(Me){function V(){const n=Date.now()%1e12,e=Math.floor(Math.random()*1024),o=Math.floor(Math.random()*4096);return`LCG${n}${e.toString().padStart(3,"0")}${o.toString().padStart(4,"0")}`}const v=F({name:""}),_=r([]),z=r(!1),K=Number(localStorage.getItem(q))||10,m=F({currentPage:1,pageSize:K,total:0}),g=r(!1),h=r(""),D=r(),y=r(!1),S=r(null),w=r(!1),C=r(null),i=F({id:"",name:"",key:"",remark:"",status:"active",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),N={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],key:[{required:!0,message:"请输入角色标识",trigger:"blur"}]},O=[{id:"menu-1",label:"配置管理",children:[{id:"menu-1-1",label:"地域管理"},{id:"menu-1-2",label:"逻辑集群"},{id:"menu-1-3",label:"逻辑集群组"},{id:"menu-1-4",label:"商品套餐"}]},{id:"menu-2",label:"网元管理",children:[{id:"menu-2-1",label:"ADS"},{id:"menu-2-2",label:"SLB"},{id:"menu-2-3",label:"WAF"},{id:"menu-2-4",label:"WAF-CC"},{id:"menu-2-5",label:"黑洞"},{id:"menu-2-6",label:"流量分析"}]},{id:"menu-3",label:"客户管理"},{id:"menu-4",label:"用户管理"},{id:"menu-5",label:"系统管理",children:[{id:"menu-5-1",label:"全局配置"},{id:"menu-5-2",label:"角色管理"},{id:"menu-5-3",label:"用户管理"}]}],G={label:"label",children:"children"},U=r([]),R=[{id:V(),name:"管理员",key:"admin",remark:"系统超级管理员，拥有所有权限",status:"active",createTime:"2024-01-01 10:00:00",createAccount:"system",updateTime:"2024-01-10 12:00:00",updateAccount:"system",resources:["menu-1","menu-2","menu-3","menu-4","menu-5"]},{id:V(),name:"普通用户",key:"user",remark:"普通业务操作员",status:"active",createTime:"2024-01-05 09:30:00",createAccount:"admin",updateTime:"2024-01-15 14:20:00",updateAccount:"admin",resources:["menu-1-1","menu-1-2","menu-3","menu-4"]},{id:V(),name:"访客",key:"guest",remark:"只读权限",status:"disabled",createTime:"2024-01-08 11:00:00",createAccount:"admin",updateTime:"2024-01-20 16:00:00",updateAccount:"admin",resources:["menu-1-1","menu-3"]}],$=()=>{z.value=!0,setTimeout(()=>{_.value=R,m.total=R.length,z.value=!1},500)},W=ke(()=>{let n=_.value;if(v.name){const e=v.name.trim().toLowerCase();n=n.filter(o=>o.name.toLowerCase().includes(e))}return n}),A=()=>{m.currentPage=1,$()},Y=()=>{Object.assign(v,{name:""}),A()},Z=()=>{h.value="新增角色",Object.assign(i,{id:"",name:"",key:"",remark:"",status:"active",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),g.value=!0},H=n=>{h.value="编辑角色",Object.assign(i,n),g.value=!0},J=n=>{S.value=n,y.value=!0},Q=()=>{const n=_.value.findIndex(e=>e.id===S.value.id);n>-1&&(_.value.splice(n,1),m.total--,x.success("删除成功")),y.value=!1},X=n=>{n.status=n.status==="active"?"disabled":"active",n.updateTime=new Date().toLocaleString(),n.updateAccount="current_user";const e=n.status==="active"?"启用":"禁用";x.success(`角色已${e}`)},ee=()=>{D.value.validate(n=>{if(n){const e=new Date().toLocaleString(),o="current_user";if(i.id){const p=_.value.findIndex(f=>f.id===i.id);p>-1&&Object.assign(_.value[p],{...i,updateTime:e,updateAccount:o}),x.success("编辑成功")}else{const p={...i,id:V(),createTime:e,createAccount:o,updateTime:e,updateAccount:o,resources:[]};_.value.push(p),m.total++,x.success("新增成功")}g.value=!1}})},te=n=>{C.value=n,U.value=[...n.resources||[]],w.value=!0},le=()=>{C.value&&(C.value.resources=[...U.value],C.value.updateTime=new Date().toLocaleString(),C.value.updateAccount="current_user",x.success("资源分配成功")),w.value=!1},ae=()=>{var n;(n=D.value)==null||n.resetFields()},ne=n=>{m.pageSize=n,localStorage.setItem(q,n),A()},oe=n=>{m.currentPage=n,$()},I=r(!1),T=r([]);function se(){T.value=[]}function ue(){I.value=!1}return ye(()=>{$()}),(n,e)=>{const o=u("el-button"),p=u("el-input"),f=u("el-form-item"),E=u("el-form"),M=u("el-tooltip"),c=u("el-table-column"),j=u("el-checkbox"),ie=u("el-checkbox-group"),de=u("el-icon"),re=u("el-popover"),me=u("el-tag"),pe=u("el-table"),ce=u("el-pagination"),fe=u("el-card"),L=u("el-radio"),_e=u("el-radio-group"),P=u("el-dialog"),ve=u("el-tree"),ge=Ce("loading");return B(),we("div",ze,[t(fe,{class:"box-card"},{header:l(()=>[d("div",he,[e[16]||(e[16]=d("span",null,"角色管理",-1)),t(o,{type:"primary",onClick:Z},{default:l(()=>e[15]||(e[15]=[s("新增角色")])),_:1,__:[15]})])]),default:l(()=>[d("div",De,[t(E,{inline:!0,model:v},{default:l(()=>[t(f,{label:"角色名称"},{default:l(()=>[t(p,{modelValue:v.name,"onUpdate:modelValue":e[0]||(e[0]=a=>v.name=a),placeholder:"请输入角色名称",clearable:"",style:{"max-width":"260px"},onKeyup:Ve(A,["enter"])},null,8,["modelValue"])]),_:1}),t(f,null,{default:l(()=>[t(o,{type:"primary",onClick:A},{default:l(()=>e[17]||(e[17]=[s("搜索")])),_:1,__:[17]}),t(o,{onClick:Y},{default:l(()=>e[18]||(e[18]=[s("重置")])),_:1,__:[18]})]),_:1})]),_:1},8,["model"])]),xe((B(),Se(pe,{data:W.value,style:{width:"100%","min-height":"320px"},border:"",stripe:"","max-height":"500","header-cell-style":{position:"sticky",top:0,background:"#fff",zIndex:2},"row-class-name":"dense-row",onSortChange:n.handleSortChange},{empty:l(()=>e[27]||(e[27]=[d("div",{class:"text-gray-400 py-10 text-center"},"暂无数据",-1)])),default:l(()=>[t(c,{prop:"name",label:"角色名称",width:"140",fixed:"left"},{default:l(a=>[t(M,{effect:"dark",content:a.row.name,placement:"top"},{default:l(()=>[d("span",Ue,k(a.row.name),1)]),_:2},1032,["content"])]),_:1}),t(c,{prop:"key",label:"角色标识",width:"120"},{default:l(a=>[t(M,{effect:"dark",content:a.row.key,placement:"top"},{default:l(()=>[d("span",$e,k(a.row.key),1)]),_:2},1032,["content"])]),_:1}),t(c,{prop:"remark",label:"描述",width:"200","show-overflow-tooltip":""}),t(c,{prop:"status",label:"状态",width:"100"},{header:l(()=>[e[23]||(e[23]=d("span",null,"状态",-1)),t(re,{placement:"bottom",width:"160",trigger:"click",visible:I.value,"onUpdate:visible":e[2]||(e[2]=a=>I.value=a)},{reference:l(()=>[t(de,{color:T.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:l(()=>[t(Ae(Te))]),_:1},8,["color"])]),default:l(()=>[d("div",null,[t(ie,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=a=>T.value=a)},{default:l(()=>[t(j,{label:"active"},{default:l(()=>e[19]||(e[19]=[s("启用")])),_:1,__:[19]}),t(j,{label:"disabled"},{default:l(()=>e[20]||(e[20]=[s("禁用")])),_:1,__:[20]})]),_:1},8,["modelValue"]),d("div",Ie,[t(o,{size:"small",onClick:se},{default:l(()=>e[21]||(e[21]=[s("重置")])),_:1,__:[21]}),t(o,{size:"small",type:"primary",onClick:ue},{default:l(()=>e[22]||(e[22]=[s("确定")])),_:1,__:[22]})])])]),_:1},8,["visible"])]),default:l(a=>[t(me,{type:a.row.status==="active"?"success":"danger"},{default:l(()=>[s(k(a.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"createTime",label:"创建时间",width:"160",sortable:""}),t(c,{prop:"createAccount",label:"创建人",width:"120"}),t(c,{prop:"updateTime",label:"修改时间",width:"160",sortable:""}),t(c,{prop:"updateAccount",label:"修改人",width:"120"}),t(c,{label:"操作",width:"260",fixed:"right"},{default:l(a=>[t(o,{type:"primary",link:"",size:"small",onClick:b=>H(a.row)},{default:l(()=>e[24]||(e[24]=[s("编辑")])),_:2,__:[24]},1032,["onClick"]),t(o,{type:"info",link:"",size:"small",onClick:b=>te(a.row)},{default:l(()=>e[25]||(e[25]=[s("分配资源")])),_:2,__:[25]},1032,["onClick"]),t(o,{type:a.row.status==="active"?"danger":"success",link:"",size:"small",onClick:b=>X(a.row)},{default:l(()=>[s(k(a.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(o,{type:"danger",link:"",size:"small",onClick:b=>J(a.row)},{default:l(()=>e[26]||(e[26]=[s("删除")])),_:2,__:[26]},1032,["onClick"])]),_:1})]),_:1},8,["data","onSortChange"])),[[ge,z.value]]),d("div",Pe,[t(ce,{"current-page":m.currentPage,"onUpdate:currentPage":e[3]||(e[3]=a=>m.currentPage=a),"page-size":m.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>m.pageSize=a),"page-sizes":[10,20,50,100],total:m.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:ne,onCurrentChange:oe},null,8,["current-page","page-size","total"])])]),_:1}),t(P,{modelValue:g.value,"onUpdate:modelValue":e[10]||(e[10]=a=>g.value=a),title:h.value,width:"500px",onClose:ae},{footer:l(()=>[d("span",Fe,[t(o,{onClick:e[9]||(e[9]=a=>g.value=!1)},{default:l(()=>e[30]||(e[30]=[s("取消")])),_:1,__:[30]}),t(o,{type:"primary",onClick:ee},{default:l(()=>e[31]||(e[31]=[s("确定")])),_:1,__:[31]})])]),default:l(()=>[t(E,{model:i,rules:N,ref_key:"formRef",ref:D,"label-width":"120px"},{default:l(()=>[t(f,{label:"角色名称",prop:"name"},{default:l(()=>[t(p,{modelValue:i.name,"onUpdate:modelValue":e[5]||(e[5]=a=>i.name=a),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),t(f,{label:"角色标识",prop:"key"},{default:l(()=>[t(p,{modelValue:i.key,"onUpdate:modelValue":e[6]||(e[6]=a=>i.key=a),placeholder:"如 admin、user"},null,8,["modelValue"])]),_:1}),t(f,{label:"描述",prop:"remark"},{default:l(()=>[t(p,{modelValue:i.remark,"onUpdate:modelValue":e[7]||(e[7]=a=>i.remark=a),type:"textarea",rows:2,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:l(()=>[t(_e,{modelValue:i.status,"onUpdate:modelValue":e[8]||(e[8]=a=>i.status=a)},{default:l(()=>[t(L,{label:"active"},{default:l(()=>e[28]||(e[28]=[s("启用")])),_:1,__:[28]}),t(L,{label:"disabled"},{default:l(()=>e[29]||(e[29]=[s("禁用")])),_:1,__:[29]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(P,{modelValue:w.value,"onUpdate:modelValue":e[12]||(e[12]=a=>w.value=a),title:"分配资源",width:"400px"},{footer:l(()=>[t(o,{onClick:e[11]||(e[11]=a=>w.value=!1)},{default:l(()=>e[32]||(e[32]=[s("取消")])),_:1,__:[32]}),t(o,{type:"primary",onClick:le},{default:l(()=>e[33]||(e[33]=[s("保存")])),_:1,__:[33]})]),default:l(()=>[t(ve,{data:O,"show-checkbox":"","node-key":"id","default-checked-keys":U.value,props:G,style:{"max-height":"400px",overflow:"auto"}},null,8,["default-checked-keys"])]),_:1},8,["modelValue"]),t(P,{modelValue:y.value,"onUpdate:modelValue":e[14]||(e[14]=a=>y.value=a),title:"确认删除",width:"400px"},{footer:l(()=>[t(o,{onClick:e[13]||(e[13]=a=>y.value=!1)},{default:l(()=>e[36]||(e[36]=[s("取消")])),_:1,__:[36]}),t(o,{type:"danger",onClick:Q},{default:l(()=>e[37]||(e[37]=[s("确认删除")])),_:1,__:[37]})]),default:l(()=>{var a,b;return[d("div",null,[e[34]||(e[34]=s("确定要删除角色 ")),d("b",null,k((a=S.value)==null?void 0:a.name),1),e[35]||(e[35]=s(" 吗？"))]),d("div",Re,"ID: "+k((b=S.value)==null?void 0:b.id),1)]}),_:1},8,["modelValue"])])}}},Le=be(Ee,[["__scopeId","data-v-e2641dd5"]]);export{Le as default};
