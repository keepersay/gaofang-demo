import{_ as de,r as $,a as m,c as ie,o as re,b as me,d as t,w as l,e as d,f as ce,g as P,h as f,i as pe,j as s,k as fe,t as S,E as C}from"./index-Dv7e4Fd8.js";const ve={class:"role-management"},ge={class:"card-header"},_e={class:"search-area"},be={class:"pagination-container"},ke={class:"dialog-footer"},ye={class:"text-xs text-gray-500 mt-2"},we={__name:"RoleManagement",setup(Ce){function V(){const n=Date.now()%1e12,e=Math.floor(Math.random()*1024),o=Math.floor(Math.random()*4096);return`LCG${n}${e.toString().padStart(3,"0")}${o.toString().padStart(4,"0")}`}const g=$({name:""}),v=m([]),T=m(!1),i=$({currentPage:1,pageSize:10,total:0}),_=m(!1),D=m(""),h=m(),k=m(!1),x=m(null),y=m(!1),w=m(null),u=$({id:"",name:"",key:"",remark:"",status:"active",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),j={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],key:[{required:!0,message:"请输入角色标识",trigger:"blur"}]},B=[{id:"menu-1",label:"配置管理",children:[{id:"menu-1-1",label:"地域管理"},{id:"menu-1-2",label:"逻辑集群"},{id:"menu-1-3",label:"逻辑集群组"},{id:"menu-1-4",label:"商品套餐"}]},{id:"menu-2",label:"网元管理",children:[{id:"menu-2-1",label:"ADS"},{id:"menu-2-2",label:"SLB"},{id:"menu-2-3",label:"WAF"},{id:"menu-2-4",label:"WAF-CC"},{id:"menu-2-5",label:"黑洞"},{id:"menu-2-6",label:"流量分析"}]},{id:"menu-3",label:"客户管理"},{id:"menu-4",label:"用户管理"},{id:"menu-5",label:"系统管理",children:[{id:"menu-5-1",label:"全局配置"},{id:"menu-5-2",label:"角色管理"},{id:"menu-5-3",label:"用户管理"}]}],q={label:"label",children:"children"},z=m([]),R=[{id:V(),name:"管理员",key:"admin",remark:"系统超级管理员，拥有所有权限",status:"active",createTime:"2024-01-01 10:00:00",createAccount:"system",updateTime:"2024-01-10 12:00:00",updateAccount:"system",resources:["menu-1","menu-2","menu-3","menu-4","menu-5"]},{id:V(),name:"普通用户",key:"user",remark:"普通业务操作员",status:"active",createTime:"2024-01-05 09:30:00",createAccount:"admin",updateTime:"2024-01-15 14:20:00",updateAccount:"admin",resources:["menu-1-1","menu-1-2","menu-3","menu-4"]},{id:V(),name:"访客",key:"guest",remark:"只读权限",status:"disabled",createTime:"2024-01-08 11:00:00",createAccount:"admin",updateTime:"2024-01-20 16:00:00",updateAccount:"admin",resources:["menu-1-1","menu-3"]}],A=()=>{T.value=!0,setTimeout(()=>{v.value=R,i.total=R.length,T.value=!1},500)},E=ie(()=>{let n=v.value;if(g.name){const e=g.name.trim().toLowerCase();n=n.filter(o=>o.name.toLowerCase().includes(e))}return n}),M=()=>{i.currentPage=1,A()},F=()=>{Object.assign(g,{name:""}),M()},O=()=>{D.value="新增角色",Object.assign(u,{id:"",name:"",key:"",remark:"",status:"active",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),_.value=!0},N=n=>{D.value="编辑角色",Object.assign(u,n),_.value=!0},W=n=>{x.value=n,k.value=!0},G=()=>{const n=v.value.findIndex(e=>e.id===x.value.id);n>-1&&(v.value.splice(n,1),i.total--,C.success("删除成功")),k.value=!1},K=n=>{n.status=n.status==="active"?"disabled":"active",n.updateTime=new Date().toLocaleString(),n.updateAccount="current_user";const e=n.status==="active"?"启用":"禁用";C.success(`角色已${e}`)},H=()=>{h.value.validate(n=>{if(n){const e=new Date().toLocaleString(),o="current_user";if(u.id){const c=v.value.findIndex(p=>p.id===u.id);c>-1&&Object.assign(v.value[c],{...u,updateTime:e,updateAccount:o}),C.success("编辑成功")}else{const c={...u,id:V(),createTime:e,createAccount:o,updateTime:e,updateAccount:o,resources:[]};v.value.push(c),i.total++,C.success("新增成功")}_.value=!1}})},J=n=>{w.value=n,z.value=[...n.resources||[]],y.value=!0},Q=()=>{w.value&&(w.value.resources=[...z.value],w.value.updateTime=new Date().toLocaleString(),w.value.updateAccount="current_user",C.success("资源分配成功")),y.value=!1},X=()=>{var n;(n=h.value)==null||n.resetFields()},Y=n=>{i.pageSize=n,A()},Z=n=>{i.currentPage=n,A()},ee=(n,e)=>e.status===n;return re(()=>{A()}),(n,e)=>{const o=d("el-button"),c=d("el-input"),p=d("el-form-item"),I=d("el-form"),r=d("el-table-column"),te=d("el-tag"),le=d("el-table"),ae=d("el-pagination"),ne=d("el-card"),L=d("el-radio"),oe=d("el-radio-group"),U=d("el-dialog"),se=d("el-tree"),ue=ce("loading");return P(),me("div",ve,[t(ne,{class:"box-card"},{header:l(()=>[f("div",ge,[e[14]||(e[14]=f("span",null,"角色管理",-1)),t(o,{type:"primary",onClick:O},{default:l(()=>e[13]||(e[13]=[s("新增角色")])),_:1,__:[13]})])]),default:l(()=>[f("div",_e,[t(I,{inline:!0,model:g,class:"search-form"},{default:l(()=>[t(p,{label:"角色名称"},{default:l(()=>[t(c,{modelValue:g.name,"onUpdate:modelValue":e[0]||(e[0]=a=>g.name=a),placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(o,{type:"primary",onClick:M},{default:l(()=>e[15]||(e[15]=[s("搜索")])),_:1,__:[15]}),t(o,{onClick:F},{default:l(()=>e[16]||(e[16]=[s("重置")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"])]),pe((P(),fe(le,{data:E.value,style:{width:"100%"},border:"",stripe:""},{default:l(()=>[t(r,{prop:"id",label:"ID",width:"220",fixed:"left"}),t(r,{prop:"name",label:"角色名称",width:"140"}),t(r,{prop:"key",label:"角色标识",width:"120"}),t(r,{prop:"remark",label:"描述",width:"200","show-overflow-tooltip":""}),t(r,{prop:"status",label:"状态",width:"100",filters:[{text:"启用",value:"active"},{text:"禁用",value:"disabled"}],"filter-method":ee},{default:l(a=>[t(te,{type:a.row.status==="active"?"success":"danger"},{default:l(()=>[s(S(a.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"createTime",label:"创建时间",width:"160",sortable:""}),t(r,{prop:"createAccount",label:"创建人",width:"120"}),t(r,{prop:"updateTime",label:"修改时间",width:"160",sortable:""}),t(r,{prop:"updateAccount",label:"修改人",width:"120"}),t(r,{label:"操作",width:"260",fixed:"right"},{default:l(a=>[t(o,{type:"primary",link:"",size:"small",onClick:b=>N(a.row)},{default:l(()=>e[17]||(e[17]=[s("编辑")])),_:2,__:[17]},1032,["onClick"]),t(o,{type:"info",link:"",size:"small",onClick:b=>J(a.row)},{default:l(()=>e[18]||(e[18]=[s("分配资源")])),_:2,__:[18]},1032,["onClick"]),t(o,{type:a.row.status==="active"?"danger":"success",link:"",size:"small",onClick:b=>K(a.row)},{default:l(()=>[s(S(a.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(o,{type:"danger",link:"",size:"small",onClick:b=>W(a.row)},{default:l(()=>e[19]||(e[19]=[s("删除")])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ue,T.value]]),f("div",be,[t(ae,{"current-page":i.currentPage,"onUpdate:currentPage":e[1]||(e[1]=a=>i.currentPage=a),"page-size":i.pageSize,"onUpdate:pageSize":e[2]||(e[2]=a=>i.pageSize=a),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:Y,onCurrentChange:Z},null,8,["current-page","page-size","total"])])]),_:1}),t(U,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=a=>_.value=a),title:D.value,width:"500px",onClose:X},{footer:l(()=>[f("span",ke,[t(o,{onClick:e[7]||(e[7]=a=>_.value=!1)},{default:l(()=>e[22]||(e[22]=[s("取消")])),_:1,__:[22]}),t(o,{type:"primary",onClick:H},{default:l(()=>e[23]||(e[23]=[s("确定")])),_:1,__:[23]})])]),default:l(()=>[t(I,{model:u,rules:j,ref_key:"formRef",ref:h,"label-width":"120px"},{default:l(()=>[t(p,{label:"角色名称",prop:"name"},{default:l(()=>[t(c,{modelValue:u.name,"onUpdate:modelValue":e[3]||(e[3]=a=>u.name=a),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),t(p,{label:"角色标识",prop:"key"},{default:l(()=>[t(c,{modelValue:u.key,"onUpdate:modelValue":e[4]||(e[4]=a=>u.key=a),placeholder:"如 admin、user"},null,8,["modelValue"])]),_:1}),t(p,{label:"描述",prop:"remark"},{default:l(()=>[t(c,{modelValue:u.remark,"onUpdate:modelValue":e[5]||(e[5]=a=>u.remark=a),type:"textarea",rows:2,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),t(p,{label:"状态",prop:"status"},{default:l(()=>[t(oe,{modelValue:u.status,"onUpdate:modelValue":e[6]||(e[6]=a=>u.status=a)},{default:l(()=>[t(L,{label:"active"},{default:l(()=>e[20]||(e[20]=[s("启用")])),_:1,__:[20]}),t(L,{label:"disabled"},{default:l(()=>e[21]||(e[21]=[s("禁用")])),_:1,__:[21]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(U,{modelValue:y.value,"onUpdate:modelValue":e[10]||(e[10]=a=>y.value=a),title:"分配资源",width:"400px"},{footer:l(()=>[t(o,{onClick:e[9]||(e[9]=a=>y.value=!1)},{default:l(()=>e[24]||(e[24]=[s("取消")])),_:1,__:[24]}),t(o,{type:"primary",onClick:Q},{default:l(()=>e[25]||(e[25]=[s("保存")])),_:1,__:[25]})]),default:l(()=>[t(se,{data:B,"show-checkbox":"","node-key":"id","default-checked-keys":z.value,props:q,style:{"max-height":"400px",overflow:"auto"}},null,8,["default-checked-keys"])]),_:1},8,["modelValue"]),t(U,{modelValue:k.value,"onUpdate:modelValue":e[12]||(e[12]=a=>k.value=a),title:"确认删除",width:"400px"},{footer:l(()=>[t(o,{onClick:e[11]||(e[11]=a=>k.value=!1)},{default:l(()=>e[28]||(e[28]=[s("取消")])),_:1,__:[28]}),t(o,{type:"danger",onClick:G},{default:l(()=>e[29]||(e[29]=[s("确认删除")])),_:1,__:[29]})]),default:l(()=>{var a,b;return[f("div",null,[e[26]||(e[26]=s("确定要删除角色 ")),f("b",null,S((a=x.value)==null?void 0:a.name),1),e[27]||(e[27]=s(" 吗？"))]),f("div",ye,"ID: "+S((b=x.value)==null?void 0:b.id),1)]}),_:1},8,["modelValue"])])}}},xe=de(we,[["__scopeId","data-v-5c82da50"]]);export{xe as default};
