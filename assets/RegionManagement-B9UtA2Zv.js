import{_ as ge,r as N,a as m,c as _e,o as be,b as we,d as t,w as l,e as i,R,E as v,f as ye,g as h,h as r,i as ke,j as Ve,k as s,l as xe,t as k,u as q,m as K,n as Ce}from"./index-DldNBvtt.js";const Se={class:"region-management"},ze={class:"card-header"},De={class:"search-area"},Te={class:"ellipsis-cell"},Ue={class:"mt-2 flex justify-end"},Ae={class:"mt-2 flex justify-end"},Fe={class:"pagination-container"},Re={class:"dialog-footer"},Ee={class:"text-xs text-gray-500 mt-2"},O="region-management-page-size",Ie={__name:"RegionManagement",setup(Pe){function G(){const o=Date.now()%1e12,e=Math.floor(Math.random()*1024),n=Math.floor(Math.random()*4096);return`LCG${o}${e.toString().padStart(3,"0")}${n.toString().padStart(4,"0")}`}const _=N({name:""}),b=m([]),D=m(!1),Y=Number(localStorage.getItem(O))||10,f=m({currentPage:1,pageSize:Y,total:0}),V=m(!1),Z=m(""),T=m(),U=m(!1),E=m(null),u=N({id:"",name:"",distributed:!1,status:"active",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),H={name:[{required:!0,message:"请输入地域名称",trigger:"blur"}]},x=async()=>{D.value=!0;try{b.value=await R.getRegions()}catch(o){console.error("获取地域数据失败:",o),v.error("获取地域数据失败")}finally{D.value=!1}},A=m(!1),F=m(!1),w=m([]),y=m([]);function J(){w.value=[]}function Q(){A.value=!1}function W(){y.value=[]}function X(){F.value=!1}const g=m({prop:"",order:""});_e(()=>{let o=b.value;if(_.name){const e=_.name.trim().toLowerCase();o=o.filter(n=>n.name.toLowerCase().includes(e))}return w.value.length&&(o=o.filter(e=>w.value.includes(e.distributed))),y.value.length&&(o=o.filter(e=>y.value.includes(e.status))),g.value.prop&&g.value.order&&(o=[...o].sort((e,n)=>{let d=e[g.value.prop],p=n[g.value.prop];return(g.value.prop==="createTime"||g.value.prop==="updateTime")&&(d=new Date(d).getTime(),p=new Date(p).getTime()),g.value.order==="ascending"?d-p:p-d})),o});const S=()=>{f.value.currentPage=1,x()},ee=()=>{Object.assign(_,{name:""}),S()},te=async()=>{Z.value="新建地域",Object.assign(u,{id:"",name:"",distributed:!1,status:"active",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),V.value=!0},le=async(o,e)=>{try{await R.updateRegion(o,e),v.success("编辑成功"),x()}catch(n){console.error("编辑地域失败:",n),v.error("编辑地域失败")}},ae=async o=>{try{await Ce.confirm("确定要删除该地域吗？","提示",{type:"warning"}),await R.deleteRegion(o),v.success("删除成功"),x()}catch(e){e!=="cancel"&&(console.error("删除地域失败:",e),v.error("删除地域失败"))}},oe=o=>{o.status=o.status==="active"?"disabled":"active",o.updateTime=new Date().toLocaleString(),o.updateAccount="current_user";const e=o.status==="active"?"启用":"禁用";v.success(`地域已${e}`)},ne=()=>{T.value.validate(o=>{if(o){const e=new Date().toLocaleString(),n="current_user";if(u.id){const d=b.value.findIndex(p=>p.id===u.id);d>-1&&Object.assign(b.value[d],{...u,updateTime:e,updateAccount:n}),v.success("编辑成功")}else{const d={...u,id:G(),createTime:e,createAccount:n,updateTime:e,updateAccount:n};b.value.push(d),f.value.total++,v.success("新增成功")}V.value=!1}})},se=()=>{var o;(o=T.value)==null||o.resetFields()},ie=o=>{f.value.pageSize=o,localStorage.setItem(O,o),S()},re=o=>{f.value.currentPage=o,x()};return be(()=>{x()}),(o,e)=>{const n=i("el-button"),d=i("el-input"),p=i("el-form-item"),I=i("el-form"),c=i("el-table-column"),ue=i("el-tooltip"),z=i("el-checkbox"),P=i("el-checkbox-group"),M=i("el-icon"),$=i("el-popover"),j=i("el-tag"),de=i("el-table"),pe=i("el-pagination"),me=i("el-card"),ce=i("el-switch"),B=i("el-radio"),fe=i("el-radio-group"),L=i("el-dialog"),ve=ye("loading");return h(),we("div",Se,[t(me,{class:"box-card"},{header:l(()=>[r("div",ze,[e[16]||(e[16]=r("span",null,"地域管理",-1)),t(n,{type:"primary",onClick:te},{default:l(()=>e[15]||(e[15]=[s("新建地域")])),_:1,__:[15]})])]),default:l(()=>[r("div",De,[t(I,{inline:!0,model:_},{default:l(()=>[t(p,{label:"名称"},{default:l(()=>[t(d,{modelValue:_.name,"onUpdate:modelValue":e[0]||(e[0]=a=>_.name=a),placeholder:"请输入地域名称",clearable:"",style:{"max-width":"260px"},onKeyup:Ve(S,["enter"])},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(n,{type:"primary",onClick:S},{default:l(()=>e[17]||(e[17]=[s("搜索")])),_:1,__:[17]}),t(n,{onClick:ee},{default:l(()=>e[18]||(e[18]=[s("重置")])),_:1,__:[18]})]),_:1})]),_:1},8,["model"])]),ke((h(),xe(de,{data:b.value,style:{width:"100%","min-height":"320px","margin-top":"20px"},border:"",stripe:"","max-height":"500","header-cell-style":{position:"sticky",top:0,background:"#fff",zIndex:2},"row-class-name":"dense-row"},{empty:l(()=>e[31]||(e[31]=[r("div",{class:"text-gray-400 py-10 text-center"},"暂无数据",-1)])),default:l(()=>[t(c,{prop:"id",label:"ID",width:"180",fixed:"left"}),t(c,{prop:"name",label:"名称",width:"150"},{default:l(a=>[t(ue,{effect:"dark",content:a.row.name,placement:"top"},{default:l(()=>[r("span",Te,k(a.row.name),1)]),_:2},1032,["content"])]),_:1}),t(c,{prop:"distributed",label:"分布式",width:"100"},{header:l(()=>[e[23]||(e[23]=r("span",null,"分布式",-1)),t($,{placement:"bottom",width:"160",trigger:"click",visible:A.value,"onUpdate:visible":e[2]||(e[2]=a=>A.value=a)},{reference:l(()=>[t(M,{color:w.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:l(()=>[t(q(K))]),_:1},8,["color"])]),default:l(()=>[r("div",null,[t(P,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a)},{default:l(()=>[t(z,{label:!0},{default:l(()=>e[19]||(e[19]=[s("是")])),_:1,__:[19]}),t(z,{label:!1},{default:l(()=>e[20]||(e[20]=[s("否")])),_:1,__:[20]})]),_:1},8,["modelValue"]),r("div",Ue,[t(n,{size:"small",onClick:J},{default:l(()=>e[21]||(e[21]=[s("重置")])),_:1,__:[21]}),t(n,{size:"small",type:"primary",onClick:Q},{default:l(()=>e[22]||(e[22]=[s("确定")])),_:1,__:[22]})])])]),_:1},8,["visible"])]),default:l(a=>[t(j,{type:a.row.distributed?"success":"info"},{default:l(()=>[s(k(a.row.distributed?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"status",label:"状态",width:"100"},{header:l(()=>[e[28]||(e[28]=r("span",null,"状态",-1)),t($,{placement:"bottom",width:"160",trigger:"click",visible:F.value,"onUpdate:visible":e[4]||(e[4]=a=>F.value=a)},{reference:l(()=>[t(M,{color:y.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:l(()=>[t(q(K))]),_:1},8,["color"])]),default:l(()=>[r("div",null,[t(P,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=a=>y.value=a)},{default:l(()=>[t(z,{label:"active"},{default:l(()=>e[24]||(e[24]=[s("启用")])),_:1,__:[24]}),t(z,{label:"disabled"},{default:l(()=>e[25]||(e[25]=[s("禁用")])),_:1,__:[25]})]),_:1},8,["modelValue"]),r("div",Ae,[t(n,{size:"small",onClick:W},{default:l(()=>e[26]||(e[26]=[s("重置")])),_:1,__:[26]}),t(n,{size:"small",type:"primary",onClick:X},{default:l(()=>e[27]||(e[27]=[s("确定")])),_:1,__:[27]})])])]),_:1},8,["visible"])]),default:l(a=>[t(j,{type:a.row.status==="active"?"success":"danger"},{default:l(()=>[s(k(a.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"remark",label:"备注","min-width":"200","show-overflow-tooltip":""}),t(c,{prop:"createTime",label:"创建时间",width:"160",sortable:""}),t(c,{prop:"createAccount",label:"创建人",width:"120"}),t(c,{prop:"updateTime",label:"修改时间",width:"160",sortable:""}),t(c,{prop:"updateAccount",label:"修改人",width:"120"}),t(c,{label:"操作",width:"180",fixed:"right"},{default:l(a=>[t(n,{type:"primary",link:"",size:"small",onClick:C=>le(a.row)},{default:l(()=>e[29]||(e[29]=[s("编辑")])),_:2,__:[29]},1032,["onClick"]),t(n,{type:a.row.status==="active"?"danger":"success",link:"",size:"small",onClick:C=>oe(a.row)},{default:l(()=>[s(k(a.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(n,{type:"danger",link:"",size:"small",onClick:C=>ae(a.row)},{default:l(()=>e[30]||(e[30]=[s("删除")])),_:2,__:[30]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ve,D.value]]),r("div",Fe,[t(pe,{"current-page":f.value.currentPage,"onUpdate:currentPage":e[5]||(e[5]=a=>f.value.currentPage=a),"page-size":f.value.pageSize,"onUpdate:pageSize":e[6]||(e[6]=a=>f.value.pageSize=a),"page-sizes":[10,20,50,100],total:f.value.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:ie,onCurrentChange:re},null,8,["current-page","page-size","total"])])]),_:1}),t(L,{modelValue:V.value,"onUpdate:modelValue":e[12]||(e[12]=a=>V.value=a),title:o.isEdit?"编辑地域":"新建地域",width:"500px","close-on-click-modal":!1,onClose:se},{footer:l(()=>[r("span",Re,[t(n,{onClick:e[11]||(e[11]=a=>V.value=!1)},{default:l(()=>e[34]||(e[34]=[s("取消")])),_:1,__:[34]}),t(n,{type:"primary",onClick:ne},{default:l(()=>e[35]||(e[35]=[s("确定")])),_:1,__:[35]})])]),default:l(()=>[t(I,{model:u,rules:H,ref_key:"formRef",ref:T,"label-width":"100px"},{default:l(()=>[t(p,{label:"名称",prop:"name"},{default:l(()=>[t(d,{modelValue:u.name,"onUpdate:modelValue":e[7]||(e[7]=a=>u.name=a),placeholder:"请输入地域名称"},null,8,["modelValue"])]),_:1}),t(p,{label:"分布式",prop:"distributed"},{default:l(()=>[t(ce,{modelValue:u.distributed,"onUpdate:modelValue":e[8]||(e[8]=a=>u.distributed=a),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),t(p,{label:"状态",prop:"status"},{default:l(()=>[t(fe,{modelValue:u.status,"onUpdate:modelValue":e[9]||(e[9]=a=>u.status=a)},{default:l(()=>[t(B,{label:"active"},{default:l(()=>e[32]||(e[32]=[s("启用")])),_:1,__:[32]}),t(B,{label:"disabled"},{default:l(()=>e[33]||(e[33]=[s("禁用")])),_:1,__:[33]})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"备注",prop:"remark"},{default:l(()=>[t(d,{modelValue:u.remark,"onUpdate:modelValue":e[10]||(e[10]=a=>u.remark=a),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(L,{modelValue:U.value,"onUpdate:modelValue":e[14]||(e[14]=a=>U.value=a),title:"确认删除",width:"400px"},{footer:l(()=>[t(n,{onClick:e[13]||(e[13]=a=>U.value=!1)},{default:l(()=>e[38]||(e[38]=[s("取消")])),_:1,__:[38]}),t(n,{type:"danger",onClick:o.confirmDelete},{default:l(()=>e[39]||(e[39]=[s("确认删除")])),_:1,__:[39]},8,["onClick"])]),default:l(()=>{var a,C;return[r("div",null,[e[36]||(e[36]=s("确定要删除地域 ")),r("b",null,k((a=E.value)==null?void 0:a.name),1),e[37]||(e[37]=s(" 吗？"))]),r("div",Ee,"ID: "+k((C=E.value)==null?void 0:C.id),1)]}),_:1},8,["modelValue"])])}}},$e=ge(Ie,[["__scopeId","data-v-4aaba6c0"]]);export{$e as default};
