import{_ as ue,r as M,a as m,c as de,o as pe,b as me,d as t,w as l,e as r,R as A,E as g,f as ce,g as P,h as u,i as fe,j as ge,k as s,l as _e,t as C,u as ve,m as be,n as we}from"./index-Bzf99cWH.js";const ke={class:"region-management"},ye={class:"card-header"},xe={class:"search-area"},Ce={class:"ellipsis-cell"},Ve={class:"mt-2 flex justify-end"},Se={class:"pagination-container"},ze={class:"dialog-footer"},Te={class:"text-xs text-gray-500 mt-2"},$="region-management-page-size",De={__name:"RegionManagement",setup(Ae){function F(){const o=Date.now()%1e12,e=Math.floor(Math.random()*1024),n=Math.floor(Math.random()*4096);return`LCG${o}${e.toString().padStart(3,"0")}${n.toString().padStart(4,"0")}`}const v=M({name:""}),b=m([]),S=m(!1),j=Number(localStorage.getItem($))||10,c=m({currentPage:1,pageSize:j,total:0}),k=m(!1),B=m(""),z=m(),T=m(!1),R=m(null),d=M({id:"",name:"",status:"active",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),L={name:[{required:!0,message:"请输入地域名称",trigger:"blur"}]},y=async()=>{S.value=!0;try{b.value=await A.getRegions()}catch(o){console.error("获取地域数据失败:",o),g.error("获取地域数据失败")}finally{S.value=!1}},D=m(!1),w=m([]);function N(){w.value=[]}function q(){D.value=!1}const _=m({prop:"",order:""});de(()=>{let o=b.value;if(v.name){const e=v.name.trim().toLowerCase();o=o.filter(n=>n.name.toLowerCase().includes(e))}return w.value.length&&(o=o.filter(e=>w.value.includes(e.status))),_.value.prop&&_.value.order&&(o=[...o].sort((e,n)=>{let i=e[_.value.prop],p=n[_.value.prop];return(_.value.prop==="createTime"||_.value.prop==="updateTime")&&(i=new Date(i).getTime(),p=new Date(p).getTime()),_.value.order==="ascending"?i-p:p-i})),o});const V=()=>{c.value.currentPage=1,y()},K=()=>{Object.assign(v,{name:""}),V()},O=async()=>{B.value="新建地域",Object.assign(d,{id:"",name:"",status:"active",remark:"",createTime:"",createAccount:"",updateTime:"",updateAccount:""}),k.value=!0},G=async(o,e)=>{try{await A.updateRegion(o,e),g.success("编辑成功"),y()}catch(n){console.error("编辑地域失败:",n),g.error("编辑地域失败")}},Y=async o=>{try{await we.confirm("确定要删除该地域吗？","提示",{type:"warning"}),await A.deleteRegion(o),g.success("删除成功"),y()}catch(e){e!=="cancel"&&(console.error("删除地域失败:",e),g.error("删除地域失败"))}},Z=o=>{o.status=o.status==="active"?"disabled":"active",o.updateTime=new Date().toLocaleString(),o.updateAccount="current_user";const e=o.status==="active"?"启用":"禁用";g.success(`地域已${e}`)},H=()=>{z.value.validate(o=>{if(o){const e=new Date().toLocaleString(),n="current_user";if(d.id){const i=b.value.findIndex(p=>p.id===d.id);i>-1&&Object.assign(b.value[i],{...d,updateTime:e,updateAccount:n}),g.success("编辑成功")}else{const i={...d,id:F(),createTime:e,createAccount:n,updateTime:e,updateAccount:n};b.value.push(i),c.value.total++,g.success("新增成功")}k.value=!1}})},J=()=>{var o;(o=z.value)==null||o.resetFields()},Q=o=>{c.value.pageSize=o,localStorage.setItem($,o),V()},W=o=>{c.value.currentPage=o,y()};return pe(()=>{y()}),(o,e)=>{const n=r("el-button"),i=r("el-input"),p=r("el-form-item"),h=r("el-form"),f=r("el-table-column"),X=r("el-tooltip"),U=r("el-checkbox"),ee=r("el-checkbox-group"),te=r("el-icon"),le=r("el-popover"),ae=r("el-tag"),oe=r("el-table"),ne=r("el-pagination"),se=r("el-card"),E=r("el-radio"),re=r("el-radio-group"),I=r("el-dialog"),ie=ce("loading");return P(),me("div",ke,[t(se,{class:"box-card"},{header:l(()=>[u("div",ye,[e[13]||(e[13]=u("span",null,"地域管理",-1)),t(n,{type:"primary",onClick:O},{default:l(()=>e[12]||(e[12]=[s("新建地域")])),_:1,__:[12]})])]),default:l(()=>[u("div",xe,[t(h,{inline:!0,model:v},{default:l(()=>[t(p,{label:"名称"},{default:l(()=>[t(i,{modelValue:v.name,"onUpdate:modelValue":e[0]||(e[0]=a=>v.name=a),placeholder:"请输入地域名称",clearable:"",style:{"max-width":"260px"},onKeyup:ge(V,["enter"])},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(n,{type:"primary",onClick:V},{default:l(()=>e[14]||(e[14]=[s("搜索")])),_:1,__:[14]}),t(n,{onClick:K},{default:l(()=>e[15]||(e[15]=[s("重置")])),_:1,__:[15]})]),_:1})]),_:1},8,["model"])]),fe((P(),_e(oe,{data:b.value,style:{width:"100%","min-height":"320px","margin-top":"20px"},border:"",stripe:"","max-height":"500","header-cell-style":{position:"sticky",top:0,background:"#fff",zIndex:2},"row-class-name":"dense-row"},{empty:l(()=>e[23]||(e[23]=[u("div",{class:"text-gray-400 py-10 text-center"},"暂无数据",-1)])),default:l(()=>[t(f,{prop:"id",label:"ID",width:"180",fixed:"left"}),t(f,{prop:"name",label:"名称",width:"150"},{default:l(a=>[t(X,{effect:"dark",content:a.row.name,placement:"top"},{default:l(()=>[u("span",Ce,C(a.row.name),1)]),_:2},1032,["content"])]),_:1}),t(f,{prop:"status",label:"状态",width:"100"},{header:l(()=>[e[20]||(e[20]=u("span",null,"状态",-1)),t(le,{placement:"bottom",width:"160",trigger:"click",visible:D.value,"onUpdate:visible":e[2]||(e[2]=a=>D.value=a)},{reference:l(()=>[t(te,{color:w.value.length?"#409EFF":"#909399",class:"ml-1 cursor-pointer"},{default:l(()=>[t(ve(be))]),_:1},8,["color"])]),default:l(()=>[u("div",null,[t(ee,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a)},{default:l(()=>[t(U,{label:"active"},{default:l(()=>e[16]||(e[16]=[s("启用")])),_:1,__:[16]}),t(U,{label:"disabled"},{default:l(()=>e[17]||(e[17]=[s("禁用")])),_:1,__:[17]})]),_:1},8,["modelValue"]),u("div",Ve,[t(n,{size:"small",onClick:N},{default:l(()=>e[18]||(e[18]=[s("重置")])),_:1,__:[18]}),t(n,{size:"small",type:"primary",onClick:q},{default:l(()=>e[19]||(e[19]=[s("确定")])),_:1,__:[19]})])])]),_:1},8,["visible"])]),default:l(a=>[t(ae,{type:a.row.status==="active"?"success":"danger"},{default:l(()=>[s(C(a.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"remark",label:"备注","min-width":"200","show-overflow-tooltip":""}),t(f,{prop:"createTime",label:"创建时间",width:"160",sortable:""}),t(f,{prop:"createAccount",label:"创建人",width:"120"}),t(f,{prop:"updateTime",label:"修改时间",width:"160",sortable:""}),t(f,{prop:"updateAccount",label:"修改人",width:"120"}),t(f,{label:"操作",width:"180",fixed:"right"},{default:l(a=>[t(n,{type:"primary",link:"",size:"small",onClick:x=>G(a.row)},{default:l(()=>e[21]||(e[21]=[s("编辑")])),_:2,__:[21]},1032,["onClick"]),t(n,{type:a.row.status==="active"?"danger":"success",link:"",size:"small",onClick:x=>Z(a.row)},{default:l(()=>[s(C(a.row.status==="active"?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),t(n,{type:"danger",link:"",size:"small",onClick:x=>Y(a.row)},{default:l(()=>e[22]||(e[22]=[s("删除")])),_:2,__:[22]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ie,S.value]]),u("div",Se,[t(ne,{"current-page":c.value.currentPage,"onUpdate:currentPage":e[3]||(e[3]=a=>c.value.currentPage=a),"page-size":c.value.pageSize,"onUpdate:pageSize":e[4]||(e[4]=a=>c.value.pageSize=a),"page-sizes":[10,20,50,100],total:c.value.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:Q,onCurrentChange:W},null,8,["current-page","page-size","total"])])]),_:1}),t(I,{modelValue:k.value,"onUpdate:modelValue":e[9]||(e[9]=a=>k.value=a),title:o.isEdit?"编辑地域":"新建地域",width:"500px","close-on-click-modal":!1,onClose:J},{footer:l(()=>[u("span",ze,[t(n,{onClick:e[8]||(e[8]=a=>k.value=!1)},{default:l(()=>e[26]||(e[26]=[s("取消")])),_:1,__:[26]}),t(n,{type:"primary",onClick:H},{default:l(()=>e[27]||(e[27]=[s("确定")])),_:1,__:[27]})])]),default:l(()=>[t(h,{model:d,rules:L,ref_key:"formRef",ref:z,"label-width":"100px"},{default:l(()=>[t(p,{label:"名称",prop:"name"},{default:l(()=>[t(i,{modelValue:d.name,"onUpdate:modelValue":e[5]||(e[5]=a=>d.name=a),placeholder:"请输入地域名称"},null,8,["modelValue"])]),_:1}),t(p,{label:"状态",prop:"status"},{default:l(()=>[t(re,{modelValue:d.status,"onUpdate:modelValue":e[6]||(e[6]=a=>d.status=a)},{default:l(()=>[t(E,{label:"active"},{default:l(()=>e[24]||(e[24]=[s("启用")])),_:1,__:[24]}),t(E,{label:"disabled"},{default:l(()=>e[25]||(e[25]=[s("禁用")])),_:1,__:[25]})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"备注",prop:"remark"},{default:l(()=>[t(i,{modelValue:d.remark,"onUpdate:modelValue":e[7]||(e[7]=a=>d.remark=a),type:"textarea",rows:2,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(I,{modelValue:T.value,"onUpdate:modelValue":e[11]||(e[11]=a=>T.value=a),title:"确认删除",width:"400px"},{footer:l(()=>[t(n,{onClick:e[10]||(e[10]=a=>T.value=!1)},{default:l(()=>e[30]||(e[30]=[s("取消")])),_:1,__:[30]}),t(n,{type:"danger",onClick:o.confirmDelete},{default:l(()=>e[31]||(e[31]=[s("确认删除")])),_:1,__:[31]},8,["onClick"])]),default:l(()=>{var a,x;return[u("div",null,[e[28]||(e[28]=s("确定要删除地域 ")),u("b",null,C((a=R.value)==null?void 0:a.name),1),e[29]||(e[29]=s(" 吗？"))]),u("div",Te,"ID: "+C((x=R.value)==null?void 0:x.id),1)]}),_:1},8,["modelValue"])])}}},he=ue(De,[["__scopeId","data-v-1380dffe"]]);export{he as default};
